<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Management System</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìä</text></svg>">

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.4.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.4.0/firebase-database-compat.js"></script>
</head>
<body>
    <!-- Login Screen -->
    <div id="login-screen" class="login-screen">
        <div class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <div class="login-icon">üîê</div>
                    <h1>Event Management System</h1>
                    <p>Sistema di gestione eventi professionale</p>
                </div>
                <form class="login-form" onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label for="password-input" class="form-label">Password di accesso</label>
                        <input 
                            type="password" 
                            id="password-input" 
                            class="form-control"
                            placeholder="Inserisci la password..."
                            required
                            autocomplete="current-password"
                        >
                    </div>
                    <button type="submit" class="btn btn--primary btn--full">
                        üöÄ Accedi al Sistema
                    </button>
                    <div id="login-error" class="login-error" style="display: none;">
                        ‚ùå Password non corretta. Riprova.
                    </div>
                </form>
                <div class="login-footer">
                    <p>üîí Accesso riservato ai membri autorizzati del progetto</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App (hidden initially) -->
    <div id="main-app" class="app-container" style="display: none;">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <h1>üìä Event Management Dashboard</h1>
            </div>
            <div class="header-actions">
                <div class="sync-status" id="sync-status">
                    <span class="sync-icon">üîÑ</span>
                    <span id="sync-text">Inizializzazione...</span>
                </div>
                <div class="save-indicator" id="save-indicator" style="display: none;">
                    ‚òÅÔ∏è Sincronizzato
                </div>
                <button class="btn btn--sm btn--outline" onclick="exportData()">
                    üì§ Esporta
                </button>
                <button class="btn btn--sm btn--secondary" onclick="logout()">
                    üö™ Logout
                </button>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="tab-navigation">
            <button class="tab-btn active" onclick="switchTab('impostazioni')">
                ‚öôÔ∏è Impostazioni
            </button>
            <button class="tab-btn" onclick="switchTab('dashboard')">
                üè† Dashboard
            </button>
            <button class="tab-btn" onclick="switchTab('contatti')">
                üë• Contatti
            </button>
            <button class="tab-btn" onclick="switchTab('location')">
                üìç Location
            </button>
            <button class="tab-btn" onclick="switchTab('sponsor')">
                üí∞ Sponsor
            </button>
        </nav>

        <!-- Tab Content -->
        <main class="tab-content">
            <!-- Impostazioni Tab -->
            <div id="impostazioni-tab" class="tab-pane active">
                <div class="settings-container">
                    <div class="card">
                        <div class="card__header">
                            <h2>‚öôÔ∏è Configurazione Team</h2>
                            <p>Personalizza i nomi dei membri del team che gestiranno il progetto</p>
                        </div>
                        <div class="card__body">
                            <div class="settings-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="membro1-input" class="form-label">Membro 1</label>
                                        <input type="text" id="membro1-input" class="form-control" placeholder="Nome del primo membro">
                                    </div>
                                    <div class="form-group">
                                        <label for="membro2-input" class="form-label">Membro 2</label>
                                        <input type="text" id="membro2-input" class="form-control" placeholder="Nome del secondo membro">
                                    </div>
                                    <div class="form-group">
                                        <label for="membro3-input" class="form-label">Membro 3</label>
                                        <input type="text" id="membro3-input" class="form-control" placeholder="Nome del terzo membro">
                                    </div>
                                </div>
                                <button onclick="saveSettings()" class="btn btn--primary">
                                    üíæ Salva Configurazione
                                </button>
                            </div>

                            <div class="team-preview-section">
                                <h3>üëÄ Anteprima Team</h3>
                                <div id="team-preview" class="team-preview">
                                    <!-- Populated by JavaScript -->
                                </div>
                            </div>

                            <!-- SEZIONE SINCRONIZZAZIONE FIREBASE -->
                            <div class="sync-section">
                                <h3>‚òÅÔ∏è Sincronizzazione Team Attiva</h3>
                                <div class="sync-success">
                                    <div class="success-icon">‚úÖ</div>
                                    <div class="success-content">
                                        <h4>Firebase Realtime Database Connesso</h4>
                                        <p><strong>I dati sono ora sincronizzati automaticamente</strong> tra tutti i dispositivi del team.</p>
                                        <p>Quando qualcuno modifica contatti, location o sponsor, tutti gli altri membri vedranno le modifiche istantaneamente.</p>
                                        <ul>
                                            <li>‚úÖ <strong>Sincronizzazione automatica</strong> in tempo reale</li>
                                            <li>‚úÖ <strong>Backup cloud</strong> automatico</li>
                                            <li>‚úÖ <strong>Accesso multi-dispositivo</strong> con stessi dati</li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="sync-controls">
                                    <button class="btn btn--outline" onclick="testFirebaseConnection()">
                                        üîç Testa Connessione
                                    </button>
                                    <button class="btn btn--outline" onclick="showFirebaseStats()">
                                        üìä Statistiche Sync
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Tab -->
            <div id="dashboard-tab" class="tab-pane">
                <div class="dashboard-container">
                    <h2>üìà Panoramica Progetto</h2>

                    <!-- Statistics Cards -->
                    <div class="stats-grid">
                        <div class="stat-card stat-card--contatti">
                            <div class="stat-icon">üë•</div>
                            <div class="stat-content">
                                <h3 id="total-contatti">0</h3>
                                <p>Contatti Totali</p>
                            </div>
                            <div class="stat-detail">
                                <span id="contatti-confermati">0</span> confermati
                            </div>
                        </div>

                        <div class="stat-card stat-card--location">
                            <div class="stat-icon">üìç</div>
                            <div class="stat-content">
                                <h3 id="total-location">0</h3>
                                <p>Location Valutate</p>
                            </div>
                            <div class="stat-detail">
                                <span id="location-confermate">0</span> confermate
                            </div>
                        </div>

                        <div class="stat-card stat-card--sponsor">
                            <div class="stat-icon">üí∞</div>
                            <div class="stat-content">
                                <h3 id="total-sponsor">0</h3>
                                <p>Sponsor Totali</p>
                            </div>
                            <div class="stat-detail">
                                <span id="sponsor-confermati">0</span> confermati
                            </div>
                        </div>

                        <div class="stat-card stat-card--valore">
                            <div class="stat-icon">üíµ</div>
                            <div class="stat-content">
                                <h3 id="valore-sponsor">‚Ç¨0</h3>
                                <p>Valore Totale</p>
                            </div>
                            <div class="stat-detail">
                                <span id="valore-confermato">‚Ç¨0</span> confermato
                            </div>
                        </div>

                        <div class="stat-card stat-card--priorita">
                            <div class="stat-icon">üî•</div>
                            <div class="stat-content">
                                <h3 id="priorita-alta">0</h3>
                                <p>Priorit√† Alta</p>
                            </div>
                            <div class="stat-detail">
                                Richiede attenzione
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contatti Tab -->
            <div id="contatti-tab" class="tab-pane">
                <div class="section-header">
                    <h2>üë• Gestione Contatti</h2>
                    <div class="section-actions">
                        <input type="text" id="contatti-search" placeholder="üîç Cerca contatti..." class="search-input">
                        <button onclick="addContatto()" class="btn btn--primary">
                            ‚ûï Aggiungi Contatto
                        </button>
                    </div>
                </div>

                <div class="table-container-clean">
                    <div id="contatti-empty-state" class="empty-state">
                        <div class="empty-state-icon">üìã</div>
                        <h3>Nessun contatto inserito</h3>
                        <p>Inizia aggiungendo il primo contatto per il tuo progetto</p>
                        <button onclick="addContatto()" class="btn btn--primary">‚ûï Aggiungi Primo Contatto</button>
                    </div>

                    <div class="table-scroll-clean">
                        <table class="data-table-clean" id="contatti-table">
                            <thead>
                                <tr>
                                    <th class="col-name">Nome</th>
                                    <th class="col-name">Cognome</th>
                                    <th class="col-company">Azienda</th>
                                    <th class="col-email">Email</th>
                                    <th class="col-phone">Telefono</th>
                                    <th class="col-role">Ruolo</th>
                                    <th class="col-assigned">Assegnato a</th>
                                    <th class="col-status">Stato</th>
                                    <th class="col-purpose">Scopo</th>
                                    <th class="col-date">Ultimo Contatto</th>
                                    <th class="col-date">Prossimo Follow-up</th>
                                    <th class="col-notes">Note</th>
                                    <th class="col-priority">Priorit√†</th>
                                    <th class="col-actions">Azioni</th>
                                </tr>
                            </thead>
                            <tbody id="contatti-table-body">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Location Tab -->
            <div id="location-tab" class="tab-pane">
                <div class="section-header">
                    <h2>üìç Gestione Location</h2>
                    <div class="section-actions">
                        <input type="text" id="location-search" placeholder="üîç Cerca location..." class="search-input">
                        <button onclick="addLocation()" class="btn btn--primary">
                            ‚ûï Aggiungi Location
                        </button>
                        <button onclick="toggleLocationComparison()" class="btn btn--outline" id="compare-btn">
                            üìä Confronta Location
                        </button>
                    </div>
                </div>

                <!-- SEZIONE CONFRONTO LOCATION -->
                <div id="location-comparison" class="comparison-container" style="display: none;">
                    <div class="card">
                        <div class="card__header">
                            <h3>üìä Confronto Location</h3>
                            <p>Seleziona le location da confrontare e analizza le differenze</p>
                        </div>
                        <div class="card__body">
                            <div class="comparison-controls">
                                <div class="form-group">
                                    <label class="form-label">Seleziona location da confrontare:</label>
                                    <div id="location-checkboxes" class="checkbox-group">
                                        <!-- Populated by JavaScript -->
                                    </div>
                                </div>
                                <button onclick="generateComparison()" class="btn btn--primary">
                                    üîç Genera Confronto
                                </button>
                            </div>

                            <div id="comparison-results" class="comparison-results" style="display: none;">
                                <h4>üìà Risultati Confronto</h4>
                                <div class="table-scroll-clean">
                                    <table class="data-table-clean comparison-table" id="comparison-table">
                                        <!-- Populated by JavaScript -->
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="table-container-clean">
                    <div id="location-empty-state" class="empty-state">
                        <div class="empty-state-icon">üè¢</div>
                        <h3>Nessuna location inserita</h3>
                        <p>Aggiungi le venue che stai valutando per l'evento</p>
                        <button onclick="addLocation()" class="btn btn--primary">‚ûï Aggiungi Prima Location</button>
                    </div>

                    <div class="table-scroll-clean">
                        <table class="data-table-clean" id="location-table">
                            <thead>
                                <tr>
                                    <th class="col-location-name">Nome</th>
                                    <th class="col-address">Indirizzo</th>
                                    <th class="col-contact">Referente</th>
                                    <th class="col-contact">Contatto</th>
                                    <th class="col-capacity">Capienza</th>
                                    <th class="col-budget">Budget Base (‚Ç¨)</th>
                                    <th class="col-budget">Costi Extra (‚Ç¨)</th>
                                    <th class="col-budget">Totale (‚Ç¨)</th>
                                    <th class="col-contact">Orari</th>
                                    <th class="col-services">Attrezzature</th>
                                    <th class="col-capacity">Catering</th>
                                    <th class="col-capacity">Parcheggio</th>
                                    <th class="col-contact">Trasporti</th>
                                    <th class="col-status">Status</th>
                                    <th class="col-rating">Valutazione</th>
                                    <th class="col-notes">Note</th>
                                    <th class="col-actions">Azioni</th>
                                </tr>
                            </thead>
                            <tbody id="location-table-body">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Sponsor Tab -->
            <div id="sponsor-tab" class="tab-pane">
                <div class="section-header">
                    <h2>üí∞ Gestione Sponsor</h2>
                    <div class="section-actions">
                        <input type="text" id="sponsor-search" placeholder="üîç Cerca sponsor..." class="search-input">
                        <button onclick="addSponsor()" class="btn btn--primary">
                            ‚ûï Aggiungi Sponsor
                        </button>
                    </div>
                </div>

                <!-- SEZIONE TOTALE SPONSORSHIP -->
                <div class="sponsor-summary">
                    <div class="summary-cards">
                        <div class="summary-card summary-card--total">
                            <div class="summary-icon">üí∞</div>
                            <div class="summary-content">
                                <h3 id="total-sponsorship-value">‚Ç¨0</h3>
                                <p>Valore Totale Sponsorship</p>
                                <small id="sponsor-breakdown">0 sponsor totali</small>
                            </div>
                        </div>

                        <div class="summary-card summary-card--confirmed">
                            <div class="summary-icon">‚úÖ</div>
                            <div class="summary-content">
                                <h3 id="confirmed-sponsorship-value">‚Ç¨0</h3>
                                <p>Sponsorship Confermate</p>
                                <small id="confirmed-sponsor-breakdown">0 sponsor confermati</small>
                            </div>
                        </div>

                        <div class="summary-card summary-card--pending">
                            <div class="summary-icon">‚è≥</div>
                            <div class="summary-content">
                                <h3 id="pending-sponsorship-value">‚Ç¨0</h3>
                                <p>In Negoziazione</p>
                                <small id="pending-sponsor-breakdown">0 sponsor in corso</small>
                            </div>
                        </div>

                        <div class="summary-card summary-card--target">
                            <div class="summary-icon">üéØ</div>
                            <div class="summary-content">
                                <h3 id="target-progress">0%</h3>
                                <p>Obiettivo Raggiunto</p>
                                <small>
                                    <input type="number" id="sponsor-target" placeholder="Obiettivo ‚Ç¨" 
                                           class="target-input" onchange="updateSponsorStats()" style="width: 120px; font-size: 12px;">
                                </small>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="table-container-clean">
                    <div id="sponsor-empty-state" class="empty-state">
                        <div class="empty-state-icon">ü§ù</div>
                        <h3>Nessuno sponsor inserito</h3>
                        <p>Inizia a tracciare potenziali sponsor e partnership</p>
                        <button onclick="addSponsor()" class="btn btn--primary">‚ûï Aggiungi Primo Sponsor</button>
                    </div>

                    <div class="table-scroll-clean">
                        <table class="data-table-clean" id="sponsor-table">
                            <thead>
                                <tr>
                                    <th class="col-company">Nome/Azienda</th>
                                    <th class="col-contact">Referente</th>
                                    <th class="col-email">Email</th>
                                    <th class="col-phone">Telefono</th>
                                    <th class="col-sponsor-type">Tipo Sponsor</th>
                                    <th class="col-amount">Importo (‚Ç¨)</th>
                                    <th class="col-sponsor-type">Tipo Contributo</th>
                                    <th class="col-services">Servizi</th>
                                    <th class="col-status">Status</th>
                                    <th class="col-date">Data Proposta</th>
                                    <th class="col-date">Scadenza</th>
                                    <th class="col-services">Benefici</th>
                                    <th class="col-actions">Completato</th>
                                    <th class="col-notes">Note</th>
                                    <th class="col-actions">Azioni</th>
                                </tr>
                            </thead>
                            <tbody id="sponsor-table-body">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="script.js"></script>
</body>
</html>
